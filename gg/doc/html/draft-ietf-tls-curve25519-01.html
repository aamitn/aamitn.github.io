<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    draft-ietf-tls-curve25519-01
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.29.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.29.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-tls-curve25519/">
  <meta name="description" content="Curve25519 and Curve448 for Transport Layer Security (TLS) (Internet-Draft, 2015)">
  <script src="https://www.ietf.org/lib/dt/7.29.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.29.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.29.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.29.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgred"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://tools.ietf.org/pdf/draft-ietf-tls-curve25519-01.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/draft-ietf-tls-curve25519/01/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/draft-ietf-tls-curve25519/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/tls/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-tls-curve25519@ietf.org?subject=draft-ietf-tls-curve25519" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-tls-curve25519-01.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-tls-curve25519-01.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-tls-curve25519-01.txt" title="Run an idnits check of this document">Nits</a>]

Versions: (<a href="/doc/html/draft-josefsson-tls-curve25519">draft-josefsson-tls-curve25519</a>) <a href="/doc/html/draft-ietf-tls-curve25519-00">00</a> <a href="/doc/html/draft-ietf-tls-curve25519-01"><b>01</b></a>                        </pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                       S. Josefsson
Internet-Draft                                                    SJD AB
Updates: <a href="/doc/html/rfc4492">4492</a>, <a href="/doc/html/rfc5246">5246</a> (if approved)                    M. Pegourie-Gonnard
Intended status: Informational                    Independent / PolarSSL
Expires: January 7, 2016                                    July 6, 2015


       <span class="h1">Curve25519 and Curve448 for Transport Layer Security (TLS)</span>
                      <span class="h1">draft-ietf-tls-curve25519-01</span>

Abstract

   This document specifies the use of Curve25519 and Curve448 for
   ephemeral key exchange in the Transport Layer Security (TLS) and
   Datagram TLS (DTLS) protocols.  It updates <a href="/doc/html/rfc5246">RFC 5246</a> (TLS 1.2) and <a href="/doc/html/rfc4492">RFC</a>
   <a href="/doc/html/rfc4492">4492</a> (Elliptic Curve Cryptography for TLS).

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="/doc/html/bcp78">BCP 78</a> and <a href="/doc/html/bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as &quot;work in progress.&quot;

   This Internet-Draft will expire on January 7, 2016.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016                [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   In [<a href="#ref-Curve25519">Curve25519</a>], a new elliptic curve function for use in
   cryptographic applications was introduced.  In [<a href="#ref-Ed448-Goldilocks">Ed448-Goldilocks</a>] the
   Ed448-Goldilocks curve is described.  In [<a href="#ref-I-D.irtf-cfrg-curves">I-D.irtf-cfrg-curves</a>], the
   Diffie-Hellman functions Curve25519 and Curve448 (using
   Ed448-Goldilocks curve) are specified.

   [<a id="ref-RFC4492">RFC4492</a>] defines the usage of elliptic curves for authentication and
   key agreement in TLS 1.0 and TLS 1.1, and these mechanisms are also
   applicable to TLS 1.2 [<a href="/doc/html/rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>].  The use of ECC curves for key
   exchange requires the definition and assignment of additional
   NamedCurve values.  This document specify them for Curve25519 and
   Curve448, and describe how the values are used to implement key
   agreement in (D)TLS using these cryptographic primitives.

   This document only describes usage of Curve25519 and Curve448 for
   ephemeral key exchange (ECDHE) in (D)TLS.  It does not define its use
   for signatures, since the primitive considered here is a Diffie-
   Hellman function; the related signature scheme, EddSA
   [<a href="#ref-I-D.josefsson-eddsa-ed25519">I-D.josefsson-eddsa-ed25519</a>], and how it is used in TLS/PKIX, is
   outside the scope of this document.  The use of Curve25519 and
   Curve448 with long-term keys embedded in X.509 certificates is also
   out of scope here, but see [<a href="#ref-I-D.josefsson-pkix-newcurves">I-D.josefsson-pkix-newcurves</a>].

<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  Requirements Terminology</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Data Structures and Computations</span>

<span class="h3"><a class="selflink" id="section-2.1" href="#section-2.1">2.1</a>.  Cryptographic computations</span>

   All cryptographic computations are done using the Curve25519 and
   Curve448 functions defined in [<a href="#ref-I-D.irtf-cfrg-curves">I-D.irtf-cfrg-curves</a>].  In this memo,
   these functions are considered as a black box that takes as input a
   (secret key, public key) pair and outputs a public key.  Public keys
   are defined as strings of 32 bytes for Curve25519 and 56 bytes for
   Curve448.  Secret keys are encoded as described in
   [<a href="#ref-I-D.irtf-cfrg-curves">I-D.irtf-cfrg-curves</a>].  In addition, a common public key, denoted by
   G, is shared by all users.

   An ECDHE key exchange using Curve25519 goes as follows.  Each party
   picks a secret key d uniformly at random and computes the
   corresponding public key x = Curve25519(d, G).  Parties exchange
   their public keys and compute a shared secret as x_S = Curve25519(d,



<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016                [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


   x_peer).  ECDHE for Curve448 works similarily, replacing Curve25519
   with Curve448.  The derived shared secret is used directly as the
   premaster secret, which is always exactly 32 bytes when ECDHE with
   Curve25519 is used and 56 bytes when ECDHE with Curve448 is used.

   A complete description of the Curve25519 function, as well as a few
   implementation notes, are provided in <a href="#appendix-A">Appendix A</a>.

<span class="h3"><a class="selflink" id="section-2.2" href="#section-2.2">2.2</a>.  Curve negotiation and new NamedCurve value</span>

   Curve negotiation uses the mechanisms introduced by [<a href="/doc/html/rfc4492" title="&quot;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)&quot;">RFC4492</a>],
   without modification except the following restriction: in the
   ECParameters structure, only the named_curve case can be used with
   Curve25519 or Curve448.  Accordingly, arbitrary_explicit_prime_curves
   in the Supported Curves extension does not imply support for
   Curve25519 or Curve448, even though the functions happens to be
   defined using an elliptic curve over a prime field.

   The reason for this restriction is that explicit_prime is only suited
   to the so-called Short Weierstrass representation of elliptic curves,
   while Curve25519 and Curve448 uses a different representation for
   performance and security reasons.

   This document adds a new NamedCurve value for Curve25519 and Curve448
   as follows.

         enum {
              Curve25519(TBD1),
              Curve448(TBD2),
         } NamedCurve;

   Curve25519 and Curve448 are suitable for use with DTLS [<a href="/doc/html/rfc6347" title="&quot;Datagram Transport Layer Security Version 1.2&quot;">RFC6347</a>].

   Since Curve25519 and Curve448 are Diffie-Hellman functions, and not
   applicable as signatures algorithms, clients who offer ECDHE_ECDSA
   ciphersuites and advertise support for Curve25519/Curve448 in the
   elliptic_curves ClientHello extension SHOULD also advertise support
   for at least one curve suitable for ECDSA signatures.  Servers MUST
   NOT select an ECDSA certificate if there are no common curves
   suitable for ECDSA signing.

   The public-key format for Curve25519 and Curve448 are defined in
   [<a href="#ref-I-D.irtf-cfrg-curves">I-D.irtf-cfrg-curves</a>], and in TLS the ECPointFormat enumeration
   &quot;uncompressed&quot; is used.







<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016                [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


<span class="h3"><a class="selflink" id="section-2.3" href="#section-2.3">2.3</a>.  Public key validation</span>

   With the curves defined by [<a href="/doc/html/rfc4492" title="&quot;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)&quot;">RFC4492</a>], each party must validate the
   public key sent by its peer before performing cryptographic
   computations with it.  Failing to do so allows attackers to gain
   information about the private key, to the point that they may recover
   the entire private key in a few requests, if that key is not really
   ephemeral.

   Curve25519 was designed in a way that the result of Curve25519(x, d)
   will never reveal information about d, provided it was chosen as
   prescribed, for any value of x.

   Let&#x27;s define legitimate values of x as the values that can be
   obtained as x = Curve25519(G, d&#x27;) for some d, and call the other
   values illegitimate.  The definition of the Curve25519 function shows
   that legitimate values all share the following property: the high-
   order bit of the last byte is not set.

   Since there are some implementation of the Curve25519 function that
   impose this restriction on their input and others that don&#x27;t,
   implementations of Curve25519 in TLS SHOULD reject public keys when
   the high-order bit of the last byte is set (in other words, when the
   value of the leftmost byte is greater than 0x7F) in order to prevent
   implementation fingerprinting.

   Other than this recommended check, implementations do not need to
   ensure that the public keys they receive are legitimate: this is not
   necessary for security with Curve25519.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  IANA Considerations</span>

   IANA is requested to assign numbers for Curve25519 and Curve448
   listed in <a href="#section-2.2">Section 2.2</a> to the Transport Layer Security (TLS)
   Parameters registry EC Named Curve [<a href="#ref-IANA-TLS">IANA-TLS</a>] as follows.

               +-------+-------------+---------+-----------+
               | Value | Description | DTLS-OK | Reference |
               +-------+-------------+---------+-----------+
               |  TBD1 |  Curve25519 |    Y    |  This doc |
               |       |             |         |           |
               |  TBD2 |   Curve448  |    Y    |  This doc |
               +-------+-------------+---------+-----------+








<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016                [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Security Considerations</span>

   The security considerations of [<a href="/doc/html/rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>] and most of the security
   considerations of [<a href="/doc/html/rfc4492" title="&quot;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)&quot;">RFC4492</a>] apply accordingly.  For the Curve25519
   and Curve448 primitives, the considerations in [<a href="#ref-I-D.irtf-cfrg-curves">I-D.irtf-cfrg-curves</a>]
   apply.

   Curve25519 is designed to facilitate the production of high-
   performance constant-time implementations of the Curve25519 function.
   Implementors are encouraged to use a constant-time implementation of
   the Curve25519 and Curve448 functions.  This point is of crucial
   importance if the implementation chooses to reuse its supposedly
   ephemeral key pair for many key exchanges, which some implementations
   do in order to improve performance.

   Curve25519 is believed to be at least as secure as the secp256r1
   curve defined in [<a href="/doc/html/rfc4492" title="&quot;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)&quot;">RFC4492</a>], also know as NIST P-256.  While the NIST
   curves are advertised as being chosen verifiably at random, there is
   no explanation for the seeds used to generate them.  In contrast, the
   process used to pick Curve25519 is fully documented and rigid enough
   so that independent verification has been done.  This is widely seen
   as a security advantage for Curve25519, since it prevents the
   generating party from maliciously manipulating the parameters.

   Another family of curves available in TLS, generated in a fully
   verifiable way, is the Brainpool curves [<a href="/doc/html/rfc7027" title="&quot;Elliptic Curve Cryptography (ECC) Brainpool Curves for Transport Layer Security (TLS)&quot;">RFC7027</a>].  Specifically,
   brainpoolP256 is expected to provide a level of security comparable
   to Curve25519 and NIST P-256.  However, due to the use of pseudo-
   random prime, it is significantly slower than NIST P-256, which is
   itself slower than Curve25519.

   See [<a href="#ref-SafeCurves">SafeCurves</a>] for more comparisons between elliptic curves.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Acknowledgements</span>

   Several people provided comments and suggestions that helped improve
   this document: Kurt Roeckx, Andrey Jivsov, Robert Ransom, Rich Salz,
   David McGrew, Simon Huerlimann, Ilari Liusvaara, Eric Rescorla,
   Martin Thomson.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  References</span>

<span class="h3"><a class="selflink" id="section-6.1" href="#section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>, March 1997.





<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016                [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


   [<a id="ref-RFC4492">RFC4492</a>]  Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B.
              Moeller, &quot;Elliptic Curve Cryptography (ECC) Cipher Suites
              for Transport Layer Security (TLS)&quot;, <a href="/doc/html/rfc4492">RFC 4492</a>, May 2006.

   [<a id="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, &quot;The Transport Layer Security
              (TLS) Protocol Version 1.2&quot;, <a href="/doc/html/rfc5246">RFC 5246</a>, August 2008.

   [<a id="ref-RFC6347">RFC6347</a>]  Rescorla, E. and N. Modadugu, &quot;Datagram Transport Layer
              Security Version 1.2&quot;, <a href="/doc/html/rfc6347">RFC 6347</a>, January 2012.

   [<a id="ref-I-D.irtf-cfrg-curves">I-D.irtf-cfrg-curves</a>]
              Langley, A., Salz, R., and S. Turner, &quot;Elliptic Curves for
              Security&quot;, <a href="/doc/html/draft-irtf-cfrg-curves-01">draft-irtf-cfrg-curves-01</a> (work in progress),
              January 2015.

<span class="h3"><a class="selflink" id="section-6.2" href="#section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-Curve25519">Curve25519</a>]
              Bernstein, J., &quot;Curve25519: New Diffie-Hellman Speed
              Records&quot;, LNCS 3958, pp. 207-228, February 2006,
              &lt;<a href="http://dx.doi.org/10.1007/11745853_14">http://dx.doi.org/10.1007/11745853_14</a>&gt;.

   [<a id="ref-Ed448-Goldilocks">Ed448-Goldilocks</a>]
              Hamburg, , &quot;Ed448-Goldilocks, a new elliptic curve&quot;, June
              2015, &lt;<a href="https://eprint.iacr.org/2015/625">https://eprint.iacr.org/2015/625</a>&gt;.

   [<a id="ref-IANA-TLS">IANA-TLS</a>]
              Internet Assigned Numbers Authority, &quot;Transport Layer
              Security (TLS) Parameters&quot;,
              &lt;<a href="http://www.iana.org/assignments/tls-parameters/tls-parameters.xml">http://www.iana.org/assignments/tls-parameters/</a>
              <a href="http://www.iana.org/assignments/tls-parameters/tls-parameters.xml">tls-parameters.xml</a>&gt;.

   [<a id="ref-SafeCurves">SafeCurves</a>]
              Bernstein, D. and T. Lange, &quot;SafeCurves: choosing safe
              curves for elliptic-curve cryptography.&quot;, January 2014,
              &lt;<a href="http://safecurves.cr.yp.to/">http://safecurves.cr.yp.to/</a>&gt;.

   [<a id="ref-RFC7027">RFC7027</a>]  Merkle, J. and M. Lochter, &quot;Elliptic Curve Cryptography
              (ECC) Brainpool Curves for Transport Layer Security
              (TLS)&quot;, <a href="/doc/html/rfc7027">RFC 7027</a>, October 2013.

   [<a id="ref-EFD">EFD</a>]      Bernstein, D. and T. Lange, &quot;Explicit-Formulas Database:
              XZ coordinates for Montgomery curves&quot;, January 2014,
              &lt;<a href="http://www.hyperelliptic.org/EFD/g1p/auto-montgom-xz.html">http://www.hyperelliptic.org/EFD/g1p/</a>
              <a href="http://www.hyperelliptic.org/EFD/g1p/auto-montgom-xz.html">auto-montgom-xz.html</a>&gt;.

   [<a id="ref-NaCl">NaCl</a>]     Bernstein, D., &quot;Cryptography in NaCL&quot;, March 2013,
              &lt;<a href="http://cr.yp.to/highspeed/naclcrypto-20090310.pdf">http://cr.yp.to/highspeed/naclcrypto-20090310.pdf</a>&gt;.



<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016                [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


   [<a id="ref-I-D.josefsson-pkix-newcurves">I-D.josefsson-pkix-newcurves</a>]
              Josefsson, S., &quot;Using Curve25519 and Curve448 Public Keys
              in PKIX&quot;, <a href="/doc/html/draft-josefsson-pkix-newcurves-00">draft-josefsson-pkix-newcurves-00</a> (work in
              progress), June 2015.

   [<a id="ref-I-D.josefsson-eddsa-ed25519">I-D.josefsson-eddsa-ed25519</a>]
              Josefsson, S. and N. Moller, &quot;EdDSA and Ed25519&quot;, <a href="/doc/html/draft-josefsson-eddsa-ed25519-02">draft-</a>
              <a href="/doc/html/draft-josefsson-eddsa-ed25519-02">josefsson-eddsa-ed25519-02</a> (work in progress), February
              2015.

<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">Appendix A</a>.  The curve25519 function</span>

<span class="h3"><a class="selflink" id="appendix-A.1" href="#appendix-A.1">A.1</a>.  Formulas</span>

   This section completes <a href="#section-2.1">Section 2.1</a> by defining the Curve25519
   function and the common public key G.  It is meant as an alternative,
   self-contained specification for the Curve25519 function, possibly
   easier to follow than the original paper for most implementors.

<span class="h4"><a class="selflink" id="appendix-A.1.1" href="#appendix-A.1.1">A.1.1</a>.  Field Arithmetic</span>

   Throughout this section, P denotes the integer 2^255-19 =
   0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFED.
   The letters X and Z, and their numbered variants such as x1, z2, etc.
   denote integers modulo P, that is integers between 0 and P-1 and
   every operation between them is implictly done modulo P.  For
   addition, subtraction and multiplication this means doing the
   operation in the usual way and then replacing the result with the
   remainder of its division by P.  For division, &quot;X / Z&quot; means
   mutliplying (mod P) X by the modular inverse of Z mod P.

   A convenient way to define the modular inverse of Z mod P is as
   Z^(P-2) mod P, that is Z to the power of 2^255-21 mod P.  It is also
   a practical way of computing it, using a square-and-multiply method.

   The four operations +, -, *, / modulo P are known as the field
   operations.  Techniques for efficient implementation of the field
   operations are outside the scope of this document.

<span class="h4"><a class="selflink" id="appendix-A.1.2" href="#appendix-A.1.2">A.1.2</a>.  Conversion to and from internal format</span>

   For the purpose of this section, we will define a Curve25519 point as
   a pair (X, Z) were X and Z are integers mod P (as defined above).
   Though public keys were defined to be strings of 32 bytes, internally
   they are represented as curve points.  This subsection describes the
   conversion process as two functions: PubkeyToPoint and PointToPubkey.





<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016                [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


       PubkeyToPoint:
       Input: a public key b_0, ..., b_31
       Output: a Curve25519 point (X, Z)
           1. Set X = b_0 + 256 * b_1 + ... + 256^31 * b_31 mod P
           2. Set Z = 1
           3. Output (X, Z)

       PointToPubkey:
       Input: a Curve25519 point (X, Z)
       Output: a public key b_0, ..., b_31
           1. Set x1 = X / Z mod P
           2. Set b_0, ... b_31 such that
               x1 = b_0 + 256 * b_1 + ... + 256^31 * b_31 mod P
           <a href="#section-3">3</a>. Output b_0, ..., b_31

<span class="h4"><a class="selflink" id="appendix-A.1.3" href="#appendix-A.1.3">A.1.3</a>.  Scalar Multiplication</span>

   We first introduce the DoubleAndAdd function, defined as follows
   (formulas taken from [<a href="#ref-EFD" title="&quot;Explicit-Formulas Database: XZ coordinates for Montgomery curves&quot;">EFD</a>]).

       DoubleAndAdd:
       Input: two points (X2, Z2), (X3, Z3), and an integer mod P: X1
       Output: two points (X4, Z4), (X5, Z5)
       Constant: the integer mod P: a24 = 121666 = 0x01DB42
       Variables: A, AA, B, BB, E, C, D, DA, CB are integers mod P
           1. Do the following computations mod P:
               A  = X2 + Z2
               AA = A2
               B  = X2 - Z2
               BB = B2
               E  = AA - BB
               C  = X3 + Z3
               D  = X3 - Z3
               DA = D * A
               CB = C * B
               X5 = (DA + CB)^2
               Z5 = X1 * (DA - CB)^2
               X4 = AA * BB
               Z4 = E * (BB + a24 * E)
           2. Output (X4, Z4) and (X5, Z5)

   This may be taken as the abstract definition of an arbitrary-looking
   function.  However, let&#x27;s mention &quot;the true meaning&quot; of this
   function, without justification, in order to help the reader make
   more sense of it.  It is possible to define operations &quot;+&quot; and &quot;-&quot;
   between Curve25519 points.  Then, assuming (X2, Z2) - (X3, Z3) = (X1,
   1), the DoubleAndAdd function returns points such that (X4, Z4) =
   (X2, Z2) + (X2, Z2) and (X5, Z5) = (X2, Z2) + (X3, Z3).



<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016                [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


   Taking the &quot;+&quot; operation as granted, we can define multiplication of
   a Curve25519 point by a positive integer as N * (X, Z) = (X, Z) + ...
   + (X, Z), with N point additions.  It is possible to compute this
   operation, known as scalar multiplication, using an algorithm called
   the Montgomery ladder, as follows.

       ScalarMult:
       Input: a Curve25519 point: (X, 1) and a 255-bits integer: N
       Output: a point (X1, Z1)
       Variable: a point (X2, Z2)
           0. View N as a sequence of bits b_254, ..., b_0,
               with b_254 the most significant bit
               and b_0 the least significant bit.
           1. Set X1 = 1 and Z1 = 0
           2. Set X2 = X and Z2 = 1
           3. For i from 254 downwards to 0, do:
               If b_i == 0, then:
                   Set (X2, Z2) and (X1, Z1) to the output of
                   DoubleAndAdd((X2, Z2), (X1, Z1), X)
               else:
                   Set (X1, Z1) and (X2, Z2) to the output of
                   DoubleAndAdd((X1, Z1), (X2, Z2), X)
           4. Output (X1, Z1)

<span class="h4"><a class="selflink" id="appendix-A.1.4" href="#appendix-A.1.4">A.1.4</a>.  Conclusion</span>

   We are now ready to define the Curve25519 function itself.

       Curve25519:
       Input: a public key P and a secret key S
       Output: a public key Q
       Variables: two Curve25519 points (X, Z) and (X1, Z1)
           1. Set (X, Z) = PubkeyToPoint(P)
           2. Set (X1, Z1) = ScalarMult((X, Z), S)
           3. Set Q = PointToPubkey((X1, Z1))
           4. Output Q

   The common public key G mentioned in the first paragraph of
   <a href="#section-2.1">Section 2.1</a> is defined as G = PointToPubkey((9, 1).

<span class="h3"><a class="selflink" id="appendix-A.2" href="#appendix-A.2">A.2</a>.  Test vectors</span>

   The following test vectors are taken from [<a href="#ref-NaCl" title="&quot;Cryptography in NaCL&quot;">NaCl</a>].  Compared to this
   reference, the private key strings have been applied the ClampC
   function of the reference and converted to integers in order to fit
   the description given in [<a href="#ref-Curve25519">Curve25519</a>] and the present memo.





<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016                [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


   The secret key of party A is denoted by S_a, it public key by P_a,
   and similarly for party B.  The shared secret is SS.

             S_a = 0x6A2CB91DA5FB77B12A99C0EB872F4CDF
                     4566B25172C1163C7DA518730A6D0770

             P_a = 85 20 F0 09 89 30 A7 54 74 8B 7D DC B4 3E F7 5A
                   0D BF 3A 0D 26 38 1A F4 EB A4 A9 8E AA 9B 4E 6A

             S_b = 0x6BE088FF278B2F1CFDB6182629B13B6F
                     E60E80838B7FE1794B8A4A627E08AB58

             P_b = DE 9E DB 7D 7B 7D C1 B4 D3 5B 61 C2 EC E4 35 37
                   3F 83 43 C8 5B 78 67 4D AD FC 7E 14 6F 88 2B 4F

              SS = 4A 5D 9D 5B A4 CE 2D E1 72 8E 3B F4 80 35 0F 25
                   E0 7E 21 C9 47 D1 9E 33 76 F0 9B 3C 1E 16 17 42

<span class="h3"><a class="selflink" id="appendix-A.3" href="#appendix-A.3">A.3</a>.  Side-channel considerations</span>

   Curve25519 was specifically designed so that correct, fast, constant-
   time implementations are easier to produce.  In particular, using a
   Montgomery ladder as described in the previous section ensures that,
   for any valid value of the secret key, the same sequence of field
   operations are performed, which eliminates a major source of side-
   channel leakage.

   However, merely using Curve25519 with a Montgomery ladder does not
   prevent all side-channels by itself, and some point are the
   responsibility of implementors:

   1.  In step 3 of SclarMult, avoid branches depending on b_i, as well
       as memory access patterns depending on b_i, for example by using
       safe conditional swaps on the inputs and outputs of DoubleAndAdd.

   2.  Avoid data-dependant branches and memory access patterns in the
       implementation of field operations.

   Techniques for implementing the field operations in constant time and
   with high performance are out of scope of this document.  Let&#x27;s
   mention however that, provided constant-time multiplication is
   available, division can be computed in constant time using
   exponentiation as described in <a href="#appendix-A.1.1">Appendix A.1.1</a>.

   If using constant-time implementations of the field operations is not
   convenient, an option to reduce the information leaked this way is to
   replace step 2 of the SclarMult function with:




<span class="grey">Josefsson &amp; Pegourie-GonnExpires January 7, 2016               [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey">Internet-Draft   Curve25519 and Ed448-Goldilocks for TLS       July 2015</span>


           2a. Pick Z uniformly randomly between 1 and P-1 included
           2b. Set X2 = X * Z and Z2 = Z

   This method is known as randomizing projective coordinates.  However,
   it is no guaranteed to avoid all side-channel leaks related to field
   operations.

   Side-channel attacks are an active reseach domain that still sees new
   significant results, so implementors of the Curve25519 function are
   advised to follow recent security research closely.

Authors&#x27; Addresses

   Simon Josefsson
   SJD AB

   Email: simon@josefsson.org


   Manuel Pegourie-Gonnard
   Independent / PolarSSL

   Email: mpg@elzevir.fr




























Josefsson &amp; Pegourie-GonnExpires January 7, 2016               [Page 11]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

